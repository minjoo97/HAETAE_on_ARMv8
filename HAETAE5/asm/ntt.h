#ifndef NTT_H
#define NTT_H

#include "params.h"
#include <stdint.h>

static const int32_t zetas[N] = {
    0,      26964,  -16505, 22229,  30746,  20243,  19064,  -31218, 9395,
    -30985, 22859,  -8851,  32144,  13744,  21408,  17599,  -16039, -22946,
    6241,   -19553, 10681,  22935,  22431,  -29104, 28147,  -27527, -29133,
    -20035, 20143,  -11361, 30820,  25252,  -22562, -6789,  -10049, 9383,
    16304,  -12296, 16446,  18239,  -1296,  -19725, -32076, 11782,  -17941,
    29643,  -8577,  7893,   -21464, -19646, -15130, -2391,  30608,  -23970,
    -16608, 19616,  -7941,  26533,  -19129, 27690,  7597,   -11459, 10615,
    -9430,  11591,  7814,   12697,  32114,  -3761,  -9604,  19813,  20353,
    17456,  -16267, -19555, 598,    -29942, 4538,   835,    15546,  3970,
    -27685, 1488,   8311,   -12442, 31352,  -17631, 1806,   -5342,  9790,
    29068,  16507,  -29051, 22131,  6759,   15510,  -14941, 28710,  1160,
    -31327, 24985,  11261,  -10623, -27727, 21502,  18731,  -16186, -4127,
    -18832, 12050,  -14501, 7929,   29563,  -31064, 5913,   5322,   -16405,
    2844,   29439,  5876,   -9522,  -18586, -9874,  23844,  30362,  -21442,
    9560,   17671,  -27989, 3350,   787,    -13857, 1657,   -21224, -7374,
    -9190,  2464,   25555,  -3529,  -28772, 16588,  -15739, 23475,  13666,
    5764,   30980,  13633,  -7401,  -30317, 28847,  7682,   -11808, -8796,
    14864,  -24162, -19194, 689,    -1311,  -31332, -16319, 1025,   10971,
    -23016, -2648,  -21900, -12543, -25921, 28254,  28521,  -16160, 12380,
    -12882, -30332, -16630, 23439,  7742,   17182,  17494,  5920,   13642,
    7382,   -18166, 21422,  -30274, -28190, 13283,  -20316, -9939,  10672,
    21454,  6080,   -17374, -29735, -25912, -10170, 3808,   10639,  -26985,
    -10865, 25636,  17261,  -26851, -8253,  -3304,  18282,  -2202,  -31368,
    -22243, 13882,  12069,  -11242, -7729,  -10226, 1761,   -27298, -4800,
    -17737, -22805, -3528,  65,     10770,  8908,   -23751, 26934,  21921,
    -27010, -21944, 8889,   -1035,  23224,  -9488,  -5823,  -994,   -20206,
    7655,   -16251, -22820, -27740, 15822,  23078,  13803,  -8099,  2931,
    9217,   -21126, -14203, 25492,  -12831, 7947,   17463,  -12979, 29003,
    31612,  26554,  8241,   -20175}; // q = 64513


static const int32_t inv_zetas[N] = {
    20175, -8241, -26554, -31612, -29003, 12979, -17463, -7947, 12831,
    -25492, 14203, 21126, -9217, -2931, 8099, -13803, -23078, -15822,
    27740, 22820, 16251, -7655, 20206, 994, 5823, 9488, -23224,
    1035, -8889, 21944, 27010, -21921, -26934, 23751, -8908, -10770,
    -65, 3528, 22805, 17737, 4800, 27298, -1761, 10226, 7729,
    11242, -12069, -13882, 22243, 31368, 2202, -18282, 3304, 8253,
    26851, -17261, -25636, 10865, 26985, -10639, -3808, 10170, 25912,
    29735, 17374, -6080, -21454, -10672, 9939, 20316, -13283, 28190,
    30274, -21422, 18166, -7382, -13642, -5920, -17494, -17182, -7742,
    -23439, 16630, 30332, 12882, -12380, 16160, -28521, -28254, 25921,
    12543, 21900, 2648, 23016, -10971, -1025, 16319, 31332, 1311,
    -689, 19194, 24162, -14864, 8796, 11808, -7682, -28847, 30317,
    7401, -13633, -30980, -5764, -13666, -23475, 15739, -16588, 28772,
    3529, -25555, -2464, 9190, 7374, 21224, -1657, 13857, -787,
    -3350, 27989, -17671, -9560, 21442, -30362, -23844, 9874, 18586,
    9522, -5876, -29439, -2844, 16405, -5322, -5913, 31064, -29563,
    -7929, 14501, -12050, 18832, 4127, 16186, -18731, -21502, 27727,
    10623, -11261, -24985, 31327, -1160, -28710, 14941, -15510, -6759,
    -22131, 29051, -16507, -29068, -9790, 5342, -1806, 17631, -31352,
    12442, -8311, -1488, 27685, -3970, -15546, -835, -4538, 29942,
    -598, 19555, 16267, -17456, -20353, -19813, 9604, 3761, -32114,
    -12697, -7814, -11591, 9430, -10615, 11459, -7597, -27690, 19129,
    -26533, 7941, -19616, 16608, 23970, -30608, 2391, 15130, 19646,
    21464, -7893, 8577, -29643, 17941, -11782, 32076, 19725, 1296,
    -18239, -16446, 12296, -16304, -9383, 10049, 6789, 22562, -25252,
    -30820, 11361, -20143, 20035, 29133, 27527, -28147, 29104, -22431,
    -22935, -10681, 19553, -6241, 22946, 16039, -17599, -21408, -13744,
    -32144, 8851, -22859, 30985, -9395, 31218, -19064, -20243, -30746,
    -22229, 16505, -26964, -29720
};


//#define ntt_clang
#ifdef ntt_clang
#define ntt HAETAE_NAMESPACE(ntt)
void ntt(int32_t a[N]);
#define invntt_tomont HAETAE_NAMESPACE(invntt_tomont)
void invntt_tomont(int32_t a[N]);

#else
extern void ntt(int32_t a[N], int32_t *b);
extern void invntt_tomont(int32_t a[N], int32_t *b);
#endif

#endif
